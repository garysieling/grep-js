<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title></title>

    <!-- page dependencies -->
    <link rel="stylesheet" href="lib/stylesheets/font-awesome.css">
    <link rel="stylesheet" href="lib/kendo/styles/kendo.common.min.css">
    <link rel="stylesheet" href="lib/kendo/styles/kendo.default.min.css">
    <link rel="stylesheet" href="lib/kendo/kendoconsole.css">
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

</head>
<body>


<!-- app container -->
<div id="root"></div>

<!-- global dependencies. could use require.js to load these relative to staticRoot.
     this file is served from /page, so we need to go up a level.
     need to shim all these into require. -->
<script type="text/javascript" src="lib/javascripts/jquery-1.8.2.js"></script>
<script type="text/javascript" src="lib/javascripts/underscore.js"></script>
<script type="text/javascript" src="lib/javascripts/underscore.string.js"></script>
<script type="text/javascript">_.mixin(_.string.exports());</script>
<script type="text/javascript" src="lib/javascripts/bootstrap.js"></script>
<script type="text/javascript" src="lib/javascripts/backbone.js"></script>
<script type="text/javascript" src="lib/javascripts/knockout-2.2.1.js"></script>
<script type="text/javascript" src="lib/javascripts/knockout.mapping-latest.debug.js"></script>
<script type="text/javascript" src="lib/kendo/js/kendo.web.min.js"></script>
<script type="text/javascript" src="lib/kendo/kendoconsole.js"></script>
<!--<script type="text/javascript" src="../assert.js"></script>-->

<script type="text/javascript" src="lib/javascripts/require-2.1.4-debug.js"></script>
<script>
(function(){
    "use strict";

    function either(val, fallback) {
        var templateStart = "{"+"{";
        var templateEnd = "}"+"}"

        var templateNotRendered = _(val).startsWith(templateStart) && _(val).endsWith(templateEnd);
        return templateNotRendered ? fallback : val;
    }
    
    var defaults = {
        serviceRoot: "mockServiceRoot"
        ,staticRoot: "../"
        ,aServiceEndpoint: ""
        ,isDevMode: true
        ,isLocalMode: true
    };

    var cfg = {
        serviceRoot:         either("{{serviceRoot}}", defaults.serviceRoot)
        ,staticRoot:         either("{{staticRoot}}", defaults.staticRoot)
        ,aServiceEndpoint:   either("{{aServiceEndpoint}}", defaults.aServiceEndpoint)
    };

    require.config({
        baseUrl: cfg.staticRoot
    });
    require.onError = function(e) {
        console.log('error in require: ' + e);
    };

    //    require(['{{mainModule}}'], function(crud) {});
    require(['search/main.js'], function(crud) {});

})();
</script>

</body>
</html>
